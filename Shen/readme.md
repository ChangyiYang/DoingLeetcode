# Code in here is from Shen